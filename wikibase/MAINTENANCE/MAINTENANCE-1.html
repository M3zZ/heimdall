{% set title = "Verify System File Permissions" %}

{% set description = "The RPM package manager has a number of useful options. One of these, the <code>-V</code> (or
<code>-verify</code> ) option, can be used to verify that system packages are correctly installed. The
<code>-V</code> option can be used to verify a particular package or to verify all system packages (
<code>-Va</code> ). If no output is returned, the package is installed correctly. The following table describes themeaning of output from the verify option:
<p><code>Code Meaning S File size differs. M File mode differs (includes permissions and file type). 5 The MD5 checksum
    differs. D The major and minor version numbers differ on a device file. L A mismatch occurs in a link. U The file
    ownership differs. G The file group owner differs. T The file time (mtime) differs.</code></p>The <code>rpm
    -qf</code> command can be used to determine which package a particular file belongs to. For example the following command determines which package the /etc/passwd file belongs to:
<p><code># rpm -qf /etc/passwd setup-2.5.58-7.el5</code></p>To verify the settings for the package that controls the
<code>/etc/passwd</code> file, run the following:<p><code># rpm -V setup-2.5.58-7.el5 .M...... c /etc/passwd S.5....T
    c/etc/printcap</code></p>Note that you can feed the output of the <code>rpm -qf</code> command to the <code>rpm
    -V</code> command:<p><code># rpm -V `rpm -qf /etc/passwd` .M...... c /etc/passwd S.5....T c /etc/printcap</code>
</p>" %}

{% set rationale = "It is important to confirm that packaged system files and directories are maintained with the permissions they were intended to have from the OS vendor.
<br>Note: Since packages and important files may change with new updates and releases, it is recommended to verify everything, not just a finite list of files. This can be a time consuming task and is therefore not a scored benchmark item, but is provided for those interested in additional security measures." %}

{% include 'wiki_template.jinja' with context %}
